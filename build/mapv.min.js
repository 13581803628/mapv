!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.mapv=t.mapv||{})}(this,function(t){"use strict";function n(){this._subscribers={}}function e(t,n){this._options=n||{},this._data=[],t&&this.add(t)}function i(t,n){var e;if("undefined"==typeof document){var i=require("canvas");e=new i(t,n)}else{var e=document.createElement("canvas");t&&(e.width=t),n&&(e.height=n)}return e}function r(t){t=t||{},this.gradient=t.gradient||{.25:"rgba(0, 0, 255, 1)",.55:"rgba(0, 255, 0, 1)",.85:"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"},this.maxSize=t.maxSize||35,this.minSize=t.minSize||0,this.max=t.max||100,this.initPalette()}function a(t){var n=t/2,e=t+n,r=1e4,a=new i(2*e,2*e),o=a.getContext("2d");return o.shadowBlur=n,o.shadowColor="black",o.shadowOffsetX=o.shadowOffsetY=r,o.beginPath(),o.arc(e-r,e-r,t,0,2*Math.PI,!0),o.closePath(),o.fill(),a}function o(t,n,e){for(var i,r=e.maxOpacity||.8,a=3,o=t.length;a<o;a+=4)i=4*t[a],t[a]/256>r&&(t[a]=256*r),t[a-3]=n[i],t[a-2]=n[i+1],t[a-1]=n[i+2]}function s(t,n,e){var i=e.max||100,o=e._size;void 0==o&&(o=e.size,void 0==o&&(o=13));var s=new r({gradient:e.gradient,max:i}),g=a(o),u=n,l={};u.forEach(function(t,n){var e=void 0===t.count?1:t.count,r=Math.min(1,e/i).toFixed(2);l[r]=l[r]||[],l[r].push(t)});for(var h in l)if(!isNaN(h)){var c=l[h];t.beginPath(),e.withoutAlpha||(t.globalAlpha=h),c.forEach(function(n,r){if(n.geometry){var a=n.geometry._coordinates||n.geometry.coordinates,o=n.geometry.type;if("Point"===o){var s=void 0===n.count?1:n.count;t.globalAlpha=s/i,t.drawImage(g,a[0]-g.width/2,a[1]-g.height/2)}else"LineString"===o&&gt.draw(t,n,e)}}),t.strokeStyle=s.getColor(h*i),t.stroke()}}function g(t,n,e){var i=e.strength||.3;t.strokeStyle="rgba(0,0,0,"+i+")",e=e||{};var r=n.get();if(t.save(),s(t,r,e),!e.absolute){var a=t.getImageData(0,0,t.canvas.width,t.canvas.height);o(a.data,lt.getImageData({defaultGradient:e.gradient||{.25:"rgba(0, 0, 255, 1)",.55:"rgba(0, 255, 0, 1)",.85:"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"}}),e),t.putImageData(a,0,0),t.restore()}}function u(t,n,e){var i=60*e+30,r=Math.PI/180*i;return[t.x+n*Math.cos(r),t.y+n*Math.sin(r)]}function l(t,n,e){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}function h(t,n,e){var i=l(t,n,t.VERTEX_SHADER),r=l(t,e,t.FRAGMENT_SHADER),a=t.createProgram();return t.attachShader(a,i),t.attachShader(a,r),t.linkProgram(a),t.useProgram(a),a}function c(t){var n=document.createElement("canvas"),e=n.getContext("2d");return n.width=1,n.height=1,e.fillStyle=t,e.fillRect(0,0,1,1),e.getImageData(0,0,1,1).data}function f(t,n,e){if(n){var i=h(t,pt,dt);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE),t.clear(t.COLOR_BUFFER_BIT);var r=t.canvas.width/2,a=t.canvas.height/2,o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o);var s=t.getAttribLocation(i,"a_Position");t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(s);var g=t.getUniformLocation(i,"u_FragColor"),u=c(e.strokeStyle||"red");t.uniform4f(g,u[0]/255,u[1]/255,u[2]/255,u[3]/255),t.lineWidth(e.lineWidth||1);for(var l=0,f=n.length;l<f;l++){for(var p=n[l].geometry._coordinates,d=[],v=0;v<p.length;v++){var y=p[v],m=(y[0]-r)/r,x=(a-y[1])/a;d.push(m,x)}var w=new Float32Array(d);t.bufferData(t.ARRAY_BUFFER,w,t.STATIC_DRAW),t.drawArrays(t.LINE_STRIP,0,p.length)}}}function p(t,n,e){if(n){var i=h(t,yt,mt),r=t.getAttribLocation(i,"a_Position"),a=t.getAttribLocation(i,"a_PointSize"),o=t.getUniformLocation(i,"u_FragColor");t.clear(t.COLOR_BUFFER_BIT);for(var s=t.canvas.width/2,g=t.canvas.height/2,u=[],l=0,f=0;f<n.length;f++){var p=n[f].geometry._coordinates,d=(p[0]-s)/s,v=(g-p[1])/g;d<-1||d>1||v<-1||v>1||(u.push(d,v),l++)}var y=new Float32Array(u),m=l,x=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,x),t.bufferData(t.ARRAY_BUFFER,y,t.STATIC_DRAW),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r),t.vertexAttrib1f(a,e._size);var w=c(e.fillStyle||"red");t.uniform4f(o,w[0]/255,w[1]/255,w[2]/255,w[3]/255),t.drawArrays(t.POINTS,0,m)}}function d(t,n,e){e=e||2;var i=n&&n.length,r=i?n[0]*e:t.length,a=v(t,0,r,e,!0),o=[];if(!a)return o;var s,g,u,l,h,c,f;if(i&&(a=S(t,n,a,e)),t.length>80*e){s=u=t[0],g=l=t[1];for(var p=e;p<r;p+=e)h=t[p],c=t[p+1],h<s&&(s=h),c<g&&(g=c),h>u&&(u=h),c>l&&(l=c);f=Math.max(u-s,l-g)}return m(a,o,e,s,g,f),o}function v(t,n,e,i,r){var a,o;if(r===W(t,n,e,i)>0)for(a=n;a<e;a+=i)o=Z(a,t[a],t[a+1],o);else for(a=e-i;a>=n;a-=i)o=Z(a,t[a],t[a+1],o);return o&&k(o,o.next)&&(q(o),o=o.next),o}function y(t,n){if(!t)return t;n||(n=t);var e,i=t;do if(e=!1,i.steiner||!k(i,i.next)&&0!==T(i.prev,i,i.next))i=i.next;else{if(q(i),i=n=i.prev,i===i.next)return null;e=!0}while(e||i!==n);return n}function m(t,n,e,i,r,a,o){if(t){!o&&a&&C(t,i,r,a);for(var s,g,u=t;t.prev!==t.next;)if(s=t.prev,g=t.next,a?w(t,i,r,a):x(t))n.push(s.i/e),n.push(t.i/e),n.push(g.i/e),q(t),t=g.next,u=g.next;else if(t=g,t===u){o?1===o?(t=_(t,n,e),m(t,n,e,i,r,a,2)):2===o&&b(t,n,e,i,r,a):m(y(t),n,e,i,r,a,1);break}}}function x(t){var n=t.prev,e=t,i=t.next;if(T(n,e,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(z(n.x,n.y,e.x,e.y,i.x,i.y,r.x,r.y)&&T(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function w(t,n,e,i){var r=t.prev,a=t,o=t.next;if(T(r,a,o)>=0)return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,g=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,u=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,l=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,h=R(s,g,n,e,i),c=R(u,l,n,e,i),f=t.nextZ;f&&f.z<=c;){if(f!==t.prev&&f!==t.next&&z(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&T(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&z(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&T(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function _(t,n,e){var i=t;do{var r=i.prev,a=i.next.next;!k(r,a)&&B(r,i,i.next,a)&&O(r,a)&&O(a,r)&&(n.push(r.i/e),n.push(i.i/e),n.push(a.i/e),q(i),q(i.next),i=t=a),i=i.next}while(i!==t);return i}function b(t,n,e,i,r,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&I(o,s)){var g=U(o,s);return o=y(o,o.next),g=y(g,g.next),m(o,n,e,i,r,a),void m(g,n,e,i,r,a)}s=s.next}o=o.next}while(o!==t)}function S(t,n,e,i){var r,a,o,s,g,u=[];for(r=0,a=n.length;r<a;r++)o=n[r]*i,s=r<a-1?n[r+1]*i:t.length,g=v(t,o,s,i,!1),g===g.next&&(g.steiner=!0),u.push(E(g));for(u.sort(M),r=0;r<u.length;r++)A(u[r],e),e=y(e,e.next);return e}function M(t,n){return t.x-n.x}function A(t,n){if(n=L(t,n)){var e=U(n,t);y(e,e.next)}}function L(t,n){var e,i=n,r=t.x,a=t.y,o=-(1/0);do{if(a<=i.y&&a>=i.next.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o){if(o=s,s===r){if(a===i.y)return i;if(a===i.next.y)return i.next}e=i.x<i.next.x?i:i.next}}i=i.next}while(i!==n);if(!e)return null;if(r===o)return e.prev;var g,u=e,l=e.x,h=e.y,c=1/0;for(i=e.next;i!==u;)r>=i.x&&i.x>=l&&z(a<h?r:o,a,l,h,a<h?o:r,a,i.x,i.y)&&(g=Math.abs(a-i.y)/(r-i.x),(g<c||g===c&&i.x>e.x)&&O(i,t)&&(e=i,c=g)),i=i.next;return e}function C(t,n,e,i){var r=t;do null===r.z&&(r.z=R(r.x,r.y,n,e,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,F(r)}function F(t){var n,e,i,r,a,o,s,g,u=1;do{for(e=t,t=null,a=null,o=0;e;){for(o++,i=e,s=0,n=0;n<u&&(s++,i=i.nextZ,i);n++);for(g=u;s>0||g>0&&i;)0===s?(r=i,i=i.nextZ,g--):0!==g&&i?e.z<=i.z?(r=e,e=e.nextZ,s--):(r=i,i=i.nextZ,g--):(r=e,e=e.nextZ,s--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;e=i}a.nextZ=null,u*=2}while(o>1);return t}function R(t,n,e,i,r){return t=32767*(t-e)/r,n=32767*(n-i)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),n=16711935&(n|n<<8),n=252645135&(n|n<<4),n=858993459&(n|n<<2),n=1431655765&(n|n<<1),t|n<<1}function E(t){var n=t,e=t;do n.x<e.x&&(e=n),n=n.next;while(n!==t);return e}function z(t,n,e,i,r,a,o,s){return(r-o)*(n-s)-(t-o)*(a-s)>=0&&(t-o)*(i-s)-(e-o)*(n-s)>=0&&(e-o)*(a-s)-(r-o)*(i-s)>=0}function I(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!D(t,n)&&O(t,n)&&O(n,t)&&N(t,n)}function T(t,n,e){return(n.y-t.y)*(e.x-n.x)-(n.x-t.x)*(e.y-n.y)}function k(t,n){return t.x===n.x&&t.y===n.y}function B(t,n,e,i){return!!(k(t,n)&&k(e,i)||k(t,i)&&k(e,n))||T(t,n,e)>0!=T(t,n,i)>0&&T(e,i,t)>0!=T(e,i,n)>0}function D(t,n){var e=t;do{if(e.i!==t.i&&e.next.i!==t.i&&e.i!==n.i&&e.next.i!==n.i&&B(e,e.next,t,n))return!0;e=e.next}while(e!==t);return!1}function O(t,n){return T(t.prev,t,t.next)<0?T(t,n,t.next)>=0&&T(t,t.prev,n)>=0:T(t,n,t.prev)<0||T(t,t.next,n)<0}function N(t,n){var e=t,i=!1,r=(t.x+n.x)/2,a=(t.y+n.y)/2;do e.y>a!=e.next.y>a&&r<(e.next.x-e.x)*(a-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==t);return i}function U(t,n){var e=new H(t.i,t.x,t.y),i=new H(n.i,n.x,n.y),r=t.next,a=n.prev;return t.next=n,n.prev=t,e.next=r,r.prev=e,i.next=e,e.prev=i,a.next=i,i.prev=a,i}function Z(t,n,e,i){var r=new H(t,n,e);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function q(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function H(t,n,e){this.i=t,this.x=n,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function W(t,n,e,i){for(var r=0,a=n,o=e-i;a<e;a+=i)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}function j(t,n,e){if(n){t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,t.canvas.width,t.canvas.height);var i=h(t,wt,_t);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE);var r=t.canvas.width/2,a=t.canvas.height/2;t.bindBuffer(t.ARRAY_BUFFER,t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,t.createBuffer());var o=t.getAttribLocation(i,"a_Position");t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(o);var s=t.getUniformLocation(i,"u_FragColor"),g=c(e.fillStyle||"red");t.uniform4f(s,g[0]/255,g[1]/255,g[2]/255,g[3]/255),t.lineWidth(e.lineWidth||1);for(var u=[],l=[],f=65536,p=0,v=0,y=n.length;v<y;v++){var m=d.flatten(n[v].geometry._coordinates||n[v].geometry.coordinates),x=m.vertices;p=u.length/2;for(var w=0;w<x.length;w+=2)x[w]=(x[w]-r)/r,x[w+1]=(a-x[w+1])/a;(u.length+x.length)/2>f&&(t.bufferData(t.ARRAY_BUFFER,new Float32Array(u),t.STATIC_DRAW),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(l),t.STATIC_DRAW),t.drawElements(t.TRIANGLES,l.length,t.UNSIGNED_SHORT,0),u.length=0,l.length=0,p=0);for(var w=0;w<x.length;w++)u.push(x[w]);for(var _=d(x,m.holes,m.dimensions),w=0;w<_.length;w++)l.push(_[w]+p)}t.bufferData(t.ARRAY_BUFFER,new Float32Array(u),t.STATIC_DRAW),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(l),t.STATIC_DRAW),t.drawElements(t.TRIANGLES,l.length,t.UNSIGNED_SHORT,0),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}}function Y(t){var n=t.split("|");return n[0]=n[0].split(","),{lng:parseFloat(n[0][0]),lat:parseFloat(n[0][1])}}function G(t){for(var n=[],e=0;e<t.length-1;e++){var i=V(t[e],t[e+1]);i&&i.length>0&&(n=n.concat(i))}return n}function V(t,n){if(!t||!n)return null;var e,i,r,a,o,s,g,u=function(t){return 1-2*t+t*t},l=function(t){return 2*t-2*t*t},h=function(t){return t*t},c=[],f=40,p=0,d=0;if("undefined"==typeof n)return void("undefined"!=typeof c&&(c=[]));var v=parseFloat(t.lat),y=parseFloat(n.lat),m=parseFloat(t.lng),x=parseFloat(n.lng);for(x>m&&parseFloat(x-m)>180&&m<0&&(m=parseFloat(360+m)),m>x&&parseFloat(m-x)>180&&x<0&&(x=parseFloat(360+x)),s=0,g=0,y==v?(e=0,i=m-x):x==m?(e=Math.PI/2,i=v-y):(e=Math.atan((y-v)/(x-m)),i=(y-v)/Math.sin(e)),0==g&&(g=e+Math.PI/5),r=i/2,o=r*Math.cos(g)+m,a=r*Math.sin(g)+v,p=0;p<f+1;p++)c.push([m*u(d)+o*l(d)+x*h(d),v*u(d)+a*l(d)+y*h(d)]),d+=1/f;return c}function J(t){this.splitList=t||{other:1}}function Q(t){this.splitList=t||[{start:0,value:"red"}]}function X(t,n){this.running=!1,this.callback=t,this.setOptions(n),this._tick=this._tick.bind(this)}function K(t){this.options=t||{},this.paneName=this.options.paneName||"mapPane",this.context=this.options.context||"2d",this.zIndex=this.options.zIndex||0,this.mixBlendMode=this.options.mixBlendMode||null,this.enableMassClear=this.options.enableMassClear,this._map=t.map,this._lastDrawTime=null,this.show()}function $(t){requestAnimationFrame($),Ft.update(t)}function tt(t,n,i){n instanceof e||(n=new e(n)),this.dataSet=n;var r=this;i=i||{},r.map=t,r.init(i),r.argCheck(i),r.transferToMercator(),this.dataSet.on("change",function(){r.transferToMercator()});var a=this.canvasLayer=new K({map:t,context:this.context,paneName:i.paneName,mixBlendMode:i.mixBlendMode,enableMassClear:i.enableMassClear,zIndex:i.zIndex,update:function(){r._canvasUpdate()}});n.on("change",function(){a.draw()}),this.clickEvent=this.clickEvent.bind(this),this.mousemoveEvent=this.mousemoveEvent.bind(this),this.bindEvent()}function nt(t){function n(t,n){return function(){n.apply(t)}}this.isAdded_=!1,this.isAnimated_=!1,this.paneName_=nt.DEFAULT_PANE_NAME_,this.updateHandler_=null,this.resizeHandler_=null,this.topLeft_=null,this.centerListener_=null,this.resizeListener_=null,this.needsResize_=!0,this.requestAnimationFrameId_=null;var e=document.createElement("canvas");e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.pointerEvents="none",this.canvas=e,this.canvasCssWidth_=300,this.canvasCssHeight_=150,this.resolutionScale_=1,this.repositionFunction_=n(this,this.repositionCanvas_),this.resizeFunction_=n(this,this.resize_),this.requestUpdateFunction_=n(this,this.update_),t&&this.setOptions(t)}function et(t,n,i){function a(){var r=h.canvas.getContext("2d");rt(r);for(var a in i)r[a]=i[a];for(var l=0,c=0,f=0,p=t.getProjection(),d=Math.pow(2,t.zoom)*u,v=p.fromLatLngToPoint(h.getTopLeft()),y=n.get({transferCoordinate:function(t){var n=new google.maps.LatLng(t[1],t[0]),e=p.fromLatLngToPoint(n),i={x:(e.x-v.x)*d,y:(e.y-v.y)*d};return[i.x,i.y]}}),m=0;m<y.length;m++){var x=y[m];"bubble"==i.draw?y[m].size=o.getSize(x.count):"intensity"==i.draw?"LineString"===y[m].geometry.type?y[m].strokeStyle=o.getColor(x.count):y[m].fillStyle=o.getColor(x.count):"category"==i.draw?y[m].fillStyle=s.get(x.count):"choropleth"==i.draw&&(y[m].fillStyle=g.get(x.count))}Math.max(Math.max(l,c),f);if("heatmap"==i.draw)ht.draw(r,new e(y),i);else if("grid"==i.draw||"honeycomb"==i.draw){for(var w=n.get(),_=w[0].geometry.coordinates[0],b=w[0].geometry.coordinates[1],m=1;m<w.length;m++)w[m].geometry.coordinates[0]<_&&(_=w[m].geometry.coordinates[0]),w[m].geometry.coordinates[1]>b&&(b=w[m].geometry.coordinates[1]);var S=new google.maps.LatLng(_,b),M=p.fromLatLngToPoint(S);i.offset={x:(M.x-v.x)*d,y:(M.y-v.y)*d},"grid"==i.draw?ct.draw(r,new e(y),i):ft.draw(r,new e(y),i)}else console.log("hehe"),ut.draw(r,new e(y),i)}var o=new r({maxSize:i.maxSize,gradient:i.gradient,max:i.max}),s=new J(i.splitList),g=new Q(i.splitList),u=window.devicePixelRatio||1,l={map:t,animate:!1,updateHandler:a,resolutionScale:u},h=new nt(l)}var it="2.0.11",rt=function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)},at=function(t){var n=window.devicePixelRatio;t.canvas.width=t.canvas.width*n,t.canvas.height=t.canvas.height*n,t.canvas.style.width=t.canvas.width/n+"px",t.canvas.style.height=t.canvas.height/n+"px",t.scale(n,n)};n.prototype.on=function(t,n){var e=this._subscribers[t];e||(e=[],this._subscribers[t]=e),e.push({callback:n})},n.prototype.off=function(t,n){var e=this._subscribers[t];if(e)for(var i=0;i<e.length;i++)e[i].callback==n&&(e.splice(i,1),i--)},n.prototype._trigger=function(t,n,e){if("*"==t)throw new Error("Cannot trigger event *");var i=[];t in this._subscribers&&(i=i.concat(this._subscribers[t])),"*"in this._subscribers&&(i=i.concat(this._subscribers["*"]));for(var r=0,a=i.length;r<a;r++){var o=i[r];o.callback&&o.callback(t,n,e||null)}};var ot=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},st=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}();e.prototype=new n,e.prototype.add=function(t,n){if(Array.isArray(t))for(var e=0,i=t.length;e<i;e++){if(t[e].time&&14==t[e].time.length&&"20"==t[e].time.substr(0,2)){var r=t[e].time;t[e].time=new Date(r.substr(0,4)+"-"+r.substr(4,2)+"-"+r.substr(6,2)+" "+r.substr(8,2)+":"+r.substr(10,2)+":"+r.substr(12,2)).getTime()}this._data.push(t[e])}else{if(!(t instanceof Object))throw new Error("Unknown dataType");this._data.push(t)}},e.prototype.get=function(t){t=t||{};var n=(new Date,this._data);new Date;if(t.filter){for(var e=[],i=0;i<n.length;i++)t.filter(n[i])&&e.push(n[i]);n=e}return t.transferCoordinate&&(n=this.transferCoordinate(n,t.transferCoordinate,t.fromColumn,t.toColumn)),n},e.prototype.set=function(t){this._set(t),this._trigger("change")},e.prototype._set=function(t){this.clear(),this.add(t)},e.prototype.clear=function(t){this._data=[]},e.prototype.remove=function(t){},e.prototype.update=function(t){},e.prototype.transferCoordinate=function(t,n,e,i){function r(t){for(var e=[],i=0;i<t.length;i++){for(var r=t[i],a=[],o=0;o<r.length;o++)a.push(n(r[o]));e.push(a)}return e}i=i||"_coordinates",e=e||"coordinates";for(var a=0;a<t.length;a++){t[a];if(t[a].geometry){if("Point"===t[a].geometry.type){var o=t[a].geometry[e];t[a].geometry[i]=n(o)}if("Polygon"===t[a].geometry.type||"MultiPolygon"===t[a].geometry.type){var o=t[a].geometry[e];if("Polygon"===t[a].geometry.type){var s=r(o);t[a].geometry[i]=s}else if("MultiPolygon"===t[a].geometry.type){for(var s=[],g=0;g<o.length;g++){var u=o[g],u=r(u);s.push(u)}t[a].geometry[i]=s}}if("LineString"===t[a].geometry.type){for(var o=t[a].geometry[e],s=[],l=0;l<o.length;l++)s.push(n(o[l]));t[a].geometry[i]=s}}}return t},e.prototype.initGeometry=function(t){t?this._data.forEach(function(n){n.geometry=t(n)}):this._data.forEach(function(t){!t.geometry&&t.lng&&t.lat&&(t.geometry={type:"Point",coordinates:[t.lng,t.lat]})})},e.prototype.getMax=function(t){var n=this._data;if(n&&!(n.length<=0)){for(var e=parseFloat(n[0][t]),i=1;i<n.length;i++){var r=parseFloat(n[i][t]);r>e&&(e=r)}return e}},e.prototype.getSum=function(t){var n=this._data;if(n&&!(n.length<=0)){for(var e=0,i=0;i<n.length;i++)n[i][t]&&(e+=parseFloat(n[i][t]));return e}},e.prototype.getMin=function(t){var n=this._data;if(n&&!(n.length<=0)){for(var e=parseFloat(n[0][t]),i=1;i<n.length;i++){var r=parseFloat(n[i][t]);r<e&&(e=r)}return e}};var gt={drawDataSet:function(t,n,i){for(var r=n instanceof e?n.get():n,a=0,o=r.length;a<o;a++){var s=r[a];this.draw(t,s,i)}},draw:function(t,n,e){var i=n.geometry.type,r=n.geometry._coordinates||n.geometry.coordinates;e.symbol||"circle";switch(i){case"Point":var a=n._size||n.size||e._size||e.size||5;"rect"===e.symbol?t.rect(r[0]-a/2,r[1]-a/2,a,a):(t.moveTo(r[0],r[1]),t.arc(r[0],r[1],a,0,2*Math.PI));break;case"LineString":for(var o=0;o<r.length;o++){var s=r[o][0],g=r[o][1];0==o?t.moveTo(s,g):t.lineTo(s,g)}break;case"Polygon":this.drawPolygon(t,r);break;case"MultiPolygon":for(var u=0;u<r.length;u++){var l=r[u];this.drawPolygon(t,l)}t.closePath();break;default:console.log("type"+i+"is not support now!")}},drawPolygon:function(t,n){for(var e=0;e<n.length;e++){var i=n[e];t.moveTo(i[0][0],i[0][1]);for(var r=1;r<i.length;r++)t.lineTo(i[r][0],i[r][1]);t.lineTo(i[0][0],i[0][1])}}},ut={draw:function(t,n,i){var r=n instanceof e?n.get():n;t.save();for(var a in i)t[a]=i[a];if(i.bigData){t.save(),t.beginPath();for(var o=0,s=r.length;o<s;o++){var g=r[o];gt.draw(t,g,i)}var u=i.bigData;"Point"==u||"Polygon"==u||"MultiPolygon"==u?(t.fill(),(g.strokeStyle||i.strokeStyle)&&i.lineWidth&&t.stroke()):"LineString"==u&&t.stroke(),t.restore()}else for(var o=0,s=r.length;o<s;o++){var g=r[o];t.save(),g.fillStyle&&(t.fillStyle=g.fillStyle),g.strokeStyle&&(t.strokeStyle=g.strokeStyle);var u=g.geometry.type;t.beginPath(),gt.draw(t,g,i),"Point"==u||"Polygon"==u||"MultiPolygon"==u?(t.fill(),(g.strokeStyle||i.strokeStyle)&&i.lineWidth&&t.stroke()):"LineString"==u&&t.stroke(),t.restore()}t.restore()}},lt={getImageData:function(t){var n=t.gradient||t.defaultGradient,e=new i(256,1),r=e.getContext("2d"),a=r.createLinearGradient(0,0,256,1);for(var o in n)a.addColorStop(parseFloat(o),n[o]);return r.fillStyle=a,r.fillRect(0,0,256,1),r.getImageData(0,0,256,1).data}};r.prototype.initPalette=function(){var t=this.gradient,n=new i(256,1),e=this.paletteCtx=n.getContext("2d"),r=e.createLinearGradient(0,0,256,1);for(var a in t)r.addColorStop(parseFloat(a),t[a]);e.fillStyle=r,e.fillRect(0,0,256,1)},r.prototype.getColor=function(t){var n=this.getImageData(t);return"rgba("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]/256+")"},r.prototype.getImageData=function(t){var n=this.max;t>n&&(t=n);var e=4*Math.floor(t/n*255),i=this.paletteCtx.getImageData(0,0,256,1).data;return[i[e],i[e+1],i[e+2],i[e+3]]},r.prototype.getSize=function(t){var n=0,e=this.max,i=this.maxSize,r=this.minSize;return t>e&&(t=e),n=r+t/e*(i-r)},r.prototype.getLegend=function(t){var n=this.gradient,e=t.width||20,r=t.height||180,a=new i(e,r),o=a.getContext("2d"),s=o.createLinearGradient(0,r,0,0);for(var g in n)s.addColorStop(parseFloat(g),n[g]);return o.fillStyle=s,o.fillRect(0,0,e,r),a};var ht={draw:g},ct={draw:function(t,n,e){t.save();for(var i=n.get(),a={},o=e._size||e.size||50,s=e.offset||{x:0,y:0},g=0;g<i.length;g++){var u=i[g].geometry._coordinates||i[g].geometry.coordinates,l=Math.floor((u[0]-s.x)/o)+","+Math.floor((u[1]-s.y)/o);a[l]||(a[l]=0),a[l]+=~~(i[g].count||1)}for(var l in a){l=l.split(",");var h=new r({max:e.max||100,gradient:e.gradient});t.beginPath(),t.rect(l[0]*o+.5+s.x,l[1]*o+.5+s.y,o,o),t.fillStyle=h.getColor(a[l]),t.fill(),e.showText&&(t.fillStyle="white",t.fillText(a[l],l[0]*o+.5+s.x+o/2,l[1]*o+.5+s.y+o/2)),e.strokeStyle&&e.lineWidth&&t.stroke()}t.restore()}},ft={draw:function(t,n,e){t.save();var i=n.get();for(var a in e)t[a]=e[a];var o=e.offset||{x:10,y:10},s=e._size||e.size||40;s=s/2/Math.sin(Math.PI/3);for(var g=2*s*Math.sin(Math.PI/3),l=1.5*s,h={},c=0;c<i.length;c++){var f=i[c].geometry._coordinates||i[c].geometry.coordinates,p=(f[1]-o.y)/l,d=Math.round(p),v=(f[0]-o.x)/g-(1&d?.5:0),y=Math.round(v),m=p-d;if(3*Math.abs(m)>1){var x=v-y,w=y+(v<y?-1:1)/2,_=d+(p<d?-1:1),b=v-w,S=p-_;x*x+m*m>b*b+S*S&&(y=w+(1&d?1:-1)/2,d=_)}var M=y+"-"+d,A=h[M];A?A.push(i[c]):(A=h[M]=[i[c]],A.i=y,A.j=d,A.x=(y+(1&d?.5:0))*g,A.y=d*l)}var L=new r({max:e.max||100,maxSize:s,gradient:e.gradient});for(var a in h){var P=h[a];t.beginPath();for(var C=0;C<6;C++){var F=s,R=u({x:P.x+o.x,y:P.y+o.y},F,C);t.lineTo(R[0],R[1])}t.closePath();for(var E=0,c=0;c<P.length;c++)E+=P[c].count||1;t.fillStyle=L.getColor(E),t.fill(),e.strokeStyle&&e.lineWidth&&t.stroke()}t.restore()}},pt=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),dt=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join(""),vt={draw:f},yt=["attribute vec4 a_Position;","attribute float a_PointSize;","void main() {","gl_Position = a_Position;","gl_PointSize = a_PointSize;","}"].join(""),mt=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join(""),xt={draw:p};d.deviation=function(t,n,e,i){var r=n&&n.length,a=r?n[0]*e:t.length,o=Math.abs(W(t,0,a,e));if(r)for(var s=0,g=n.length;s<g;s++){var u=n[s]*e,l=s<g-1?n[s+1]*e:t.length;o-=Math.abs(W(t,u,l,e))}var h=0;for(s=0;s<i.length;s+=3){var c=i[s]*e,f=i[s+1]*e,p=i[s+2]*e;h+=Math.abs((t[c]-t[p])*(t[f+1]-t[c+1])-(t[c]-t[f])*(t[p+1]-t[c+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},d.flatten=function(t){for(var n=t[0][0].length,e={vertices:[],holes:[],dimensions:n},i=0,r=0;r<t.length;r++){for(var a=0;a<t[r].length;a++)for(var o=0;o<n;o++)e.vertices.push(t[r][a][o]);r>0&&(i+=t[r-1].length,e.holes.push(i))}return e};var wt=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),_t=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join(""),bt={draw:j},St={draw:function(t,n,i){var r=n instanceof e?n.get():n;r.length>0&&("LineString"==r[0].geometry.type?vt.draw(t,r,i):"Polygon"==r[0].geometry.type||"MultiPolygon"==r[0].geometry.type?bt.draw(t,r,i):xt.draw(t,r,i))}},Mt={municipalities:[{n:"北京",g:"116.395645,39.929986|12"},{n:"上海",g:"121.487899,31.249162|12"},{n:"天津",g:"117.210813,39.14393|12"},{n:"重庆",g:"106.530635,29.544606|12"}],provinces:[{n:"安徽",g:"117.216005,31.859252|8",cities:[{n:"合肥",g:"117.282699,31.866942|12"},{n:"安庆",g:"117.058739,30.537898|13"},{n:"蚌埠",g:"117.35708,32.929499|13"},{n:"亳州",g:"115.787928,33.871211|13"},{n:"巢湖",g:"117.88049,31.608733|13"},{n:"池州",g:"117.494477,30.660019|14"},{n:"滁州",g:"118.32457,32.317351|13"},{n:"阜阳",g:"115.820932,32.901211|13"},{n:"淮北",g:"116.791447,33.960023|13"},{n:"淮南",g:"117.018639,32.642812|13"},{n:"黄山",g:"118.29357,29.734435|13"},{n:"六安",g:"116.505253,31.755558|13"},{n:"马鞍山",g:"118.515882,31.688528|13"},{n:"宿州",g:"116.988692,33.636772|13"},{n:"铜陵",g:"117.819429,30.94093|14"},{n:"芜湖",g:"118.384108,31.36602|12"},{n:"宣城",g:"118.752096,30.951642|13"}]},{n:"福建",g:"117.984943,26.050118|8",cities:[{n:"福州",g:"119.330221,26.047125|12"},{n:"龙岩",g:"117.017997,25.078685|13"},{n:"南平",g:"118.181883,26.643626|13"},{n:"宁德",g:"119.542082,26.656527|14"},{n:"莆田",g:"119.077731,25.44845|13"},{n:"泉州",g:"118.600362,24.901652|12"},{n:"三明",g:"117.642194,26.270835|14"},{n:"厦门",g:"118.103886,24.489231|12"},{n:"漳州",g:"117.676205,24.517065|12"}]},{n:"甘肃",g:"102.457625,38.103267|6",cities:[{n:"兰州",g:"103.823305,36.064226|12"},{n:"白银",g:"104.171241,36.546682|13"},{n:"定西",g:"104.626638,35.586056|13"},{n:"甘南州",g:"102.917442,34.992211|14"},{n:"嘉峪关",g:"98.281635,39.802397|13"},{n:"金昌",g:"102.208126,38.516072|13"},{n:"酒泉",g:"98.508415,39.741474|13"},{n:"临夏州",g:"103.215249,35.598514|13"},{n:"陇南",g:"104.934573,33.39448|14"},{n:"平凉",g:"106.688911,35.55011|13"},{n:"庆阳",g:"107.644227,35.726801|13"},{n:"天水",g:"105.736932,34.584319|13"},{n:"武威",g:"102.640147,37.933172|13"},{n:"张掖",g:"100.459892,38.93932|13"}]},{n:"广东",g:"113.394818,23.408004|8",cities:[{n:"广州",g:"113.30765,23.120049|12"},{n:"潮州",g:"116.630076,23.661812|13"},{n:"东莞",g:"113.763434,23.043024|12"},{n:"佛山",g:"113.134026,23.035095|13"},{n:"河源",g:"114.713721,23.757251|12"},{n:"惠州",g:"114.410658,23.11354|12"},{n:"江门",g:"113.078125,22.575117|13"},{n:"揭阳",g:"116.379501,23.547999|13"},{n:"茂名",g:"110.931245,21.668226|13"},{n:"梅州",g:"116.126403,24.304571|13"},{n:"清远",g:"113.040773,23.698469|13"},{n:"汕头",g:"116.72865,23.383908|13"},{n:"汕尾",g:"115.372924,22.778731|14"},{n:"韶关",g:"113.594461,24.80296|13"},{n:"深圳",g:"114.025974,22.546054|12"},{n:"阳江",g:"111.97701,21.871517|14"},{n:"云浮",g:"112.050946,22.937976|13"},{n:"湛江",g:"110.365067,21.257463|13"},{n:"肇庆",g:"112.479653,23.078663|13"},{n:"中山",g:"113.42206,22.545178|12"},{n:"珠海",g:"113.562447,22.256915|13"}]},{n:"广西",g:"108.924274,23.552255|7",cities:[{n:"南宁",g:"108.297234,22.806493|12"},{n:"百色",g:"106.631821,23.901512|13"},{n:"北海",g:"109.122628,21.472718|13"},{n:"崇左",g:"107.357322,22.415455|14"},{n:"防城港",g:"108.351791,21.617398|15"},{n:"桂林",g:"110.26092,25.262901|12"},{n:"贵港",g:"109.613708,23.103373|13"},{n:"河池",g:"108.069948,24.699521|14"},{n:"贺州",g:"111.552594,24.411054|14"},{n:"来宾",g:"109.231817,23.741166|14"},{n:"柳州",g:"109.422402,24.329053|12"},{n:"钦州",g:"108.638798,21.97335|13"},{n:"梧州",g:"111.305472,23.485395|13"},{n:"玉林",g:"110.151676,22.643974|14"}]},{n:"贵州",g:"106.734996,26.902826|8",cities:[{n:"贵阳",g:"106.709177,26.629907|12"},{n:"安顺",g:"105.92827,26.228595|13"},{n:"毕节地区",g:"105.300492,27.302612|14"},{n:"六盘水",g:"104.852087,26.591866|13"},{n:"铜仁地区",g:"109.196161,27.726271|14"},{n:"遵义",g:"106.93126,27.699961|13"},{n:"黔西南州",g:"104.900558,25.095148|11"},{n:"黔东南州",g:"107.985353,26.583992|11"},{n:"黔南州",g:"107.523205,26.264536|11"}]},{n:"海南",g:"109.733755,19.180501|9",cities:[{n:"海口",g:"110.330802,20.022071|13"},{n:"白沙",g:"109.358586,19.216056|12"},{n:"保亭",g:"109.656113,18.597592|12"},{n:"昌江",g:"109.0113,19.222483|12"},{n:"儋州",g:"109.413973,19.571153|13"},{n:"澄迈",g:"109.996736,19.693135|13"},{n:"东方",g:"108.85101,18.998161|13"},{n:"定安",g:"110.32009,19.490991|13"},{n:"琼海",g:"110.414359,19.21483|13"},{n:"琼中",g:"109.861849,19.039771|12"},{n:"乐东",g:"109.062698,18.658614|12"},{n:"临高",g:"109.724101,19.805922|13"},{n:"陵水",g:"109.948661,18.575985|12"},{n:"三亚",g:"109.522771,18.257776|12"},{n:"屯昌",g:"110.063364,19.347749|13"},{n:"万宁",g:"110.292505,18.839886|13"},{n:"文昌",g:"110.780909,19.750947|13"},{n:"五指山",g:"109.51775,18.831306|13"}]},{n:"河北",g:"115.661434,38.61384|7",cities:[{n:"石家庄",g:"114.522082,38.048958|12"},{n:"保定",g:"115.49481,38.886565|13"},{n:"沧州",g:"116.863806,38.297615|13"},{n:"承德",g:"117.933822,40.992521|14"},{n:"邯郸",g:"114.482694,36.609308|13"},{n:"衡水",g:"115.686229,37.746929|13"},{n:"廊坊",g:"116.703602,39.518611|13"},{n:"秦皇岛",g:"119.604368,39.945462|12"},{n:"唐山",g:"118.183451,39.650531|13"},{n:"邢台",g:"114.520487,37.069531|13"},{n:"张家口",g:"114.893782,40.811188|13"}]},{n:"河南",g:"113.486804,34.157184|7",cities:[{n:"郑州",g:"113.649644,34.75661|12"},{n:"安阳",g:"114.351807,36.110267|12"},{n:"鹤壁",g:"114.29777,35.755426|13"},{n:"焦作",g:"113.211836,35.234608|13"},{n:"开封",g:"114.351642,34.801854|13"},{n:"洛阳",g:"112.447525,34.657368|12"},{n:"漯河",g:"114.046061,33.576279|13"},{n:"南阳",g:"112.542842,33.01142|13"},{n:"平顶山",g:"113.300849,33.745301|13"},{n:"濮阳",g:"115.026627,35.753298|12"},{n:"三门峡",g:"111.181262,34.78332|13"},{n:"商丘",g:"115.641886,34.438589|13"},{n:"新乡",g:"113.91269,35.307258|13"},{n:"信阳",g:"114.085491,32.128582|13"},{n:"许昌",g:"113.835312,34.02674|13"},{n:"周口",g:"114.654102,33.623741|13"},{n:"驻马店",g:"114.049154,32.983158|13"}]},{n:"黑龙江",g:"128.047414,47.356592|6",cities:[{n:"哈尔滨",g:"126.657717,45.773225|12"},{n:"大庆",g:"125.02184,46.596709|12"},{n:"大兴安岭地区",g:"124.196104,51.991789|10"},{n:"鹤岗",g:"130.292472,47.338666|13"},{n:"黑河",g:"127.50083,50.25069|14"},{n:"鸡西",g:"130.941767,45.32154|13"},{n:"佳木斯",g:"130.284735,46.81378|12"},{n:"牡丹江",g:"129.608035,44.588521|13"},{n:"七台河",g:"131.019048,45.775005|14"},{n:"齐齐哈尔",g:"123.987289,47.3477|13"},{n:"双鸭山",g:"131.171402,46.655102|13"},{n:"绥化",g:"126.989095,46.646064|13"},{n:"伊春",g:"128.910766,47.734685|14"}]},{n:"湖北",g:"112.410562,31.209316|8",cities:[{n:"武汉",g:"114.3162,30.581084|12"},{n:"鄂州",g:"114.895594,30.384439|14"},{n:"恩施",g:"109.517433,30.308978|14"},{n:"黄冈",g:"114.906618,30.446109|14"},{n:"黄石",g:"115.050683,30.216127|13"},{n:"荆门",g:"112.21733,31.042611|13"},{n:"荆州",g:"112.241866,30.332591|12"},{n:"潜江",g:"112.768768,30.343116|13"},{n:"神农架林区",g:"110.487231,31.595768|13"},{n:"十堰",g:"110.801229,32.636994|13"},{n:"随州",g:"113.379358,31.717858|13"},{n:"天门",g:"113.12623,30.649047|13"},{n:"仙桃",g:"113.387448,30.293966|13"},{n:"咸宁",g:"114.300061,29.880657|13"},{n:"襄阳",g:"112.176326,32.094934|12"},{n:"孝感",g:"113.935734,30.927955|13"},{n:"宜昌",g:"111.310981,30.732758|13"}]},{n:"湖南",g:"111.720664,27.695864|7",cities:[{n:"长沙",g:"112.979353,28.213478|12"},{n:"常德",g:"111.653718,29.012149|12"},{n:"郴州",g:"113.037704,25.782264|13"},{n:"衡阳",g:"112.583819,26.898164|13"},{n:"怀化",g:"109.986959,27.557483|13"},{n:"娄底",g:"111.996396,27.741073|13"},{n:"邵阳",g:"111.461525,27.236811|13"},{n:"湘潭",g:"112.935556,27.835095|13"},{n:"湘西州",g:"109.745746,28.317951|14"},{n:"益阳",g:"112.366547,28.588088|13"},{n:"永州",g:"111.614648,26.435972|13"},{n:"岳阳",g:"113.146196,29.378007|13"},{n:"张家界",g:"110.48162,29.124889|13"},{n:"株洲",g:"113.131695,27.827433|13"}]},{n:"江苏",g:"119.368489,33.013797|8",cities:[{n:"南京",g:"118.778074,32.057236|12"},{n:"常州",g:"119.981861,31.771397|12"},{n:"淮安",g:"119.030186,33.606513|12"},{n:"连云港",g:"119.173872,34.601549|12"},{n:"南通",g:"120.873801,32.014665|12"},{n:"苏州",g:"120.619907,31.317987|12"},{n:"宿迁",g:"118.296893,33.95205|13"},{n:"泰州",g:"119.919606,32.476053|13"},{n:"无锡",g:"120.305456,31.570037|12"},{n:"徐州",g:"117.188107,34.271553|12"},{n:"盐城",g:"120.148872,33.379862|12"},{n:"扬州",g:"119.427778,32.408505|13"},{n:"镇江",g:"119.455835,32.204409|13"}]},{n:"江西",g:"115.676082,27.757258|7",cities:[{n:"南昌",g:"115.893528,28.689578|12"},{n:"抚州",g:"116.360919,27.954545|13"},{n:"赣州",g:"114.935909,25.845296|13"},{n:"吉安",g:"114.992039,27.113848|13"},{n:"景德镇",g:"117.186523,29.303563|12"},{n:"九江",g:"115.999848,29.71964|13"},{n:"萍乡",g:"113.859917,27.639544|13"
},{n:"上饶",g:"117.955464,28.457623|13"},{n:"新余",g:"114.947117,27.822322|13"},{n:"宜春",g:"114.400039,27.81113|13"},{n:"鹰潭",g:"117.03545,28.24131|13"}]},{n:"吉林",g:"126.262876,43.678846|7",cities:[{n:"长春",g:"125.313642,43.898338|12"},{n:"白城",g:"122.840777,45.621086|13"},{n:"白山",g:"126.435798,41.945859|13"},{n:"吉林市",g:"126.564544,43.871988|12"},{n:"辽源",g:"125.133686,42.923303|13"},{n:"四平",g:"124.391382,43.175525|12"},{n:"松原",g:"124.832995,45.136049|13"},{n:"通化",g:"125.94265,41.736397|13"},{n:"延边",g:"129.485902,42.896414|13"}]},{n:"辽宁",g:"122.753592,41.6216|8",cities:[{n:"沈阳",g:"123.432791,41.808645|12"},{n:"鞍山",g:"123.007763,41.118744|13"},{n:"本溪",g:"123.778062,41.325838|12"},{n:"朝阳",g:"120.446163,41.571828|13"},{n:"大连",g:"121.593478,38.94871|12"},{n:"丹东",g:"124.338543,40.129023|12"},{n:"抚顺",g:"123.92982,41.877304|12"},{n:"阜新",g:"121.660822,42.01925|14"},{n:"葫芦岛",g:"120.860758,40.74303|13"},{n:"锦州",g:"121.147749,41.130879|13"},{n:"辽阳",g:"123.172451,41.273339|14"},{n:"盘锦",g:"122.073228,41.141248|13"},{n:"铁岭",g:"123.85485,42.299757|13"},{n:"营口",g:"122.233391,40.668651|13"}]},{n:"内蒙古",g:"114.415868,43.468238|5",cities:[{n:"呼和浩特",g:"111.660351,40.828319|12"},{n:"阿拉善盟",g:"105.695683,38.843075|14"},{n:"包头",g:"109.846239,40.647119|12"},{n:"巴彦淖尔",g:"107.423807,40.76918|12"},{n:"赤峰",g:"118.930761,42.297112|12"},{n:"鄂尔多斯",g:"109.993706,39.81649|12"},{n:"呼伦贝尔",g:"119.760822,49.201636|12"},{n:"通辽",g:"122.260363,43.633756|12"},{n:"乌海",g:"106.831999,39.683177|13"},{n:"乌兰察布",g:"113.112846,41.022363|12"},{n:"锡林郭勒盟",g:"116.02734,43.939705|11"},{n:"兴安盟",g:"122.048167,46.083757|11"}]},{n:"宁夏",g:"106.155481,37.321323|8",cities:[{n:"银川",g:"106.206479,38.502621|12"},{n:"固原",g:"106.285268,36.021523|13"},{n:"石嘴山",g:"106.379337,39.020223|13"},{n:"吴忠",g:"106.208254,37.993561|14"},{n:"中卫",g:"105.196754,37.521124|14"}]},{n:"青海",g:"96.202544,35.499761|7",cities:[{n:"西宁",g:"101.767921,36.640739|12"},{n:"果洛州",g:"100.223723,34.480485|11"},{n:"海东地区",g:"102.085207,36.51761|11"},{n:"海北州",g:"100.879802,36.960654|11"},{n:"海南州",g:"100.624066,36.284364|11"},{n:"海西州",g:"97.342625,37.373799|11"},{n:"黄南州",g:"102.0076,35.522852|11"},{n:"玉树州",g:"97.013316,33.00624|14"}]},{n:"山东",g:"118.527663,36.09929|8",cities:[{n:"济南",g:"117.024967,36.682785|12"},{n:"滨州",g:"117.968292,37.405314|12"},{n:"东营",g:"118.583926,37.487121|12"},{n:"德州",g:"116.328161,37.460826|12"},{n:"菏泽",g:"115.46336,35.26244|13"},{n:"济宁",g:"116.600798,35.402122|13"},{n:"莱芜",g:"117.684667,36.233654|13"},{n:"聊城",g:"115.986869,36.455829|12"},{n:"临沂",g:"118.340768,35.072409|12"},{n:"青岛",g:"120.384428,36.105215|12"},{n:"日照",g:"119.50718,35.420225|12"},{n:"泰安",g:"117.089415,36.188078|13"},{n:"威海",g:"122.093958,37.528787|13"},{n:"潍坊",g:"119.142634,36.716115|12"},{n:"烟台",g:"121.309555,37.536562|12"},{n:"枣庄",g:"117.279305,34.807883|13"},{n:"淄博",g:"118.059134,36.804685|12"}]},{n:"山西",g:"112.515496,37.866566|7",cities:[{n:"太原",g:"112.550864,37.890277|12"},{n:"长治",g:"113.120292,36.201664|12"},{n:"大同",g:"113.290509,40.113744|12"},{n:"晋城",g:"112.867333,35.499834|13"},{n:"晋中",g:"112.738514,37.693362|13"},{n:"临汾",g:"111.538788,36.099745|13"},{n:"吕梁",g:"111.143157,37.527316|14"},{n:"朔州",g:"112.479928,39.337672|13"},{n:"忻州",g:"112.727939,38.461031|12"},{n:"阳泉",g:"113.569238,37.869529|13"},{n:"运城",g:"111.006854,35.038859|13"}]},{n:"陕西",g:"109.503789,35.860026|7",cities:[{n:"西安",g:"108.953098,34.2778|12"},{n:"安康",g:"109.038045,32.70437|13"},{n:"宝鸡",g:"107.170645,34.364081|12"},{n:"汉中",g:"107.045478,33.081569|13"},{n:"商洛",g:"109.934208,33.873907|13"},{n:"铜川",g:"108.968067,34.908368|13"},{n:"渭南",g:"109.483933,34.502358|13"},{n:"咸阳",g:"108.707509,34.345373|13"},{n:"延安",g:"109.50051,36.60332|13"},{n:"榆林",g:"109.745926,38.279439|12"}]},{n:"四川",g:"102.89916,30.367481|7",cities:[{n:"成都",g:"104.067923,30.679943|12"},{n:"阿坝州",g:"102.228565,31.905763|15"},{n:"巴中",g:"106.757916,31.869189|14"},{n:"达州",g:"107.494973,31.214199|14"},{n:"德阳",g:"104.402398,31.13114|13"},{n:"甘孜州",g:"101.969232,30.055144|15"},{n:"广安",g:"106.63572,30.463984|13"},{n:"广元",g:"105.819687,32.44104|13"},{n:"乐山",g:"103.760824,29.600958|13"},{n:"凉山州",g:"102.259591,27.892393|14"},{n:"泸州",g:"105.44397,28.89593|14"},{n:"南充",g:"106.105554,30.800965|13"},{n:"眉山",g:"103.84143,30.061115|13"},{n:"绵阳",g:"104.705519,31.504701|12"},{n:"内江",g:"105.073056,29.599462|13"},{n:"攀枝花",g:"101.722423,26.587571|14"},{n:"遂宁",g:"105.564888,30.557491|12"},{n:"雅安",g:"103.009356,29.999716|13"},{n:"宜宾",g:"104.633019,28.769675|13"},{n:"资阳",g:"104.63593,30.132191|13"},{n:"自贡",g:"104.776071,29.359157|13"}]},{n:"西藏",g:"89.137982,31.367315|6",cities:[{n:"拉萨",g:"91.111891,29.662557|13"},{n:"阿里地区",g:"81.107669,30.404557|11"},{n:"昌都地区",g:"97.185582,31.140576|15"},{n:"林芝地区",g:"94.349985,29.666941|11"},{n:"那曲地区",g:"92.067018,31.48068|14"},{n:"日喀则地区",g:"88.891486,29.269023|14"},{n:"山南地区",g:"91.750644,29.229027|11"}]},{n:"新疆",g:"85.614899,42.127001|6",cities:[{n:"乌鲁木齐",g:"87.564988,43.84038|12"},{n:"阿拉尔",g:"81.291737,40.61568|13"},{n:"阿克苏地区",g:"80.269846,41.171731|12"},{n:"阿勒泰地区",g:"88.137915,47.839744|13"},{n:"巴音郭楞",g:"86.121688,41.771362|12"},{n:"博尔塔拉州",g:"82.052436,44.913651|11"},{n:"昌吉州",g:"87.296038,44.007058|13"},{n:"哈密地区",g:"93.528355,42.858596|13"},{n:"和田地区",g:"79.930239,37.116774|13"},{n:"喀什地区",g:"75.992973,39.470627|12"},{n:"克拉玛依",g:"84.88118,45.594331|13"},{n:"克孜勒苏州",g:"76.137564,39.750346|11"},{n:"石河子",g:"86.041865,44.308259|13"},{n:"塔城地区",g:"82.974881,46.758684|12"},{n:"图木舒克",g:"79.198155,39.889223|13"},{n:"吐鲁番地区",g:"89.181595,42.96047|13"},{n:"五家渠",g:"87.565449,44.368899|13"},{n:"伊犁州",g:"81.297854,43.922248|11"}]},{n:"云南",g:"101.592952,24.864213|7",cities:[{n:"昆明",g:"102.714601,25.049153|12"},{n:"保山",g:"99.177996,25.120489|13"},{n:"楚雄州",g:"101.529382,25.066356|13"},{n:"大理州",g:"100.223675,25.5969|14"},{n:"德宏州",g:"98.589434,24.44124|14"},{n:"迪庆州",g:"99.713682,27.831029|14"},{n:"红河州",g:"103.384065,23.367718|11"},{n:"丽江",g:"100.229628,26.875351|13"},{n:"临沧",g:"100.092613,23.887806|14"},{n:"怒江州",g:"98.859932,25.860677|14"},{n:"普洱",g:"100.980058,22.788778|14"},{n:"曲靖",g:"103.782539,25.520758|12"},{n:"昭通",g:"103.725021,27.340633|13"},{n:"文山",g:"104.089112,23.401781|14"},{n:"西双版纳",g:"100.803038,22.009433|13"},{n:"玉溪",g:"102.545068,24.370447|13"}]},{n:"浙江",g:"119.957202,29.159494|8",cities:[{n:"杭州",g:"120.219375,30.259244|12"},{n:"湖州",g:"120.137243,30.877925|12"},{n:"嘉兴",g:"120.760428,30.773992|13"},{n:"金华",g:"119.652576,29.102899|12"},{n:"丽水",g:"119.929576,28.4563|13"},{n:"宁波",g:"121.579006,29.885259|12"},{n:"衢州",g:"118.875842,28.95691|12"},{n:"绍兴",g:"120.592467,30.002365|13"},{n:"台州",g:"121.440613,28.668283|13"},{n:"温州",g:"120.690635,28.002838|12"},{n:"舟山",g:"122.169872,30.03601|13"}]}],other:[{n:"香港",g:"114.186124,22.293586|11"},{n:"澳门",g:"113.557519,22.204118|13"},{n:"台湾",g:"120.961454,23.80406|8"}]},At={getCenterByCityName:function(t){for(var n=0;n<Mt.municipalities.length;n++)if(Mt.municipalities[n].n==t)return Y(Mt.municipalities[n].g);for(var e=Mt.provinces,n=0;n<e.length;n++){if(e[n].n==t)return Y(e[n].g);for(var i=e[n].cities,r=0;r<i.length;r++)if(i[r].n==t)return Y(i[r].g)}return null}},Lt={getPoints:G},Pt=function(){function t(t,n){return t.x*n.x+t.y*n.y}function n(t){return{x:S[t.target].x-S[t.source].x,y:S[t.target].y-S[t.source].y}}function e(t){return Math.sqrt(Math.pow(S[t.source].x-S[t.target].x,2)+Math.pow(S[t.source].y-S[t.target].y,2))}function i(t){return Math.sqrt(Math.pow(t.source.x-t.target.x,2)+Math.pow(t.source.y-t.target.y,2))}function r(t){var n=(S[t.source].x+S[t.target].x)/2,e=(S[t.source].y+S[t.target].y)/2;return{x:n,y:e}}function a(t){for(var n=0,e=1;e<L[t].length;e++){var i=o(L[t][e],L[t][e-1]);n+=i}return n}function o(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function s(t,n){var e=Math.sqrt((n.target.x-n.source.x)*(n.target.x-n.source.x)+(n.target.y-n.source.y)*(n.target.y-n.source.y)),i=((n.source.y-t.y)*(n.source.y-n.target.y)-(n.source.x-t.x)*(n.target.x-n.source.x))/(e*e);return{x:n.source.x+i*(n.target.x-n.source.x),y:n.source.y+i*(n.target.y-n.source.y)}}function g(){for(var t=0;t<M.length;t++)1==R?L[t]=[]:(L[t]=[],L[t].push(S[M[t].source]),L[t].push(S[M[t].target]))}function u(){for(var t=0;t<M.length;t++)A[t]=[]}function l(t){for(var n=[],e=0;e<t.length;e++)S[t[e].source].x!=S[t[e].target].x&&S[t[e].source].y!=S[t[e].target].y&&n.push(t[e]);return n}function h(t,n,e){var i=L[t][n-1],r=L[t][n+1],a=L[t][n],o=i.x-a.x+r.x-a.x,s=i.y-a.y+r.y-a.y;return o*=e,s*=e,{x:o,y:s}}function c(t,n,e){for(var r={x:0,y:0},a=A[t],o=0;o<a.length;o++){var s={x:L[a[o]][n].x-L[t][n].x,y:L[a[o]][n].y-L[t][n].y};if(Math.abs(s.x)>B||Math.abs(s.y)>B){var g=1/Math.pow(i({source:L[a[o]][n],target:L[t][n]}),1);r.x+=s.x*g,r.y+=s.y*g}}return r}function f(t,n,i){for(var r=C/(e(M[t])*(n+1)),a=[{x:0,y:0}],o=1;o<n+1;o++){var s={x:0,y:0},g=h(t,o,r),u=c(t,o,i);s.x=i*(g.x+u.x),s.y=i*(g.y+u.y),a.push(s)}return a.push({x:0,y:0}),a}function p(t){for(var n=0;n<M.length;n++)if(1==t)L[n].push(S[M[n].source]),L[n].push(r(M[n])),L[n].push(S[M[n].target]);else{var e=a(n),i=e/(t+1),s=i,g=[];g.push(S[M[n].source]);for(var u=1;u<L[n].length;u++){for(var l=o(L[n][u],L[n][u-1]);l>s;){var h=s/l,c=L[n][u-1].x,f=L[n][u-1].y;c+=h*(L[n][u].x-L[n][u-1].x),f+=h*(L[n][u].y-L[n][u-1].y),g.push({x:c,y:f}),l-=s,s=i}s-=l}g.push(S[M[n].target]),L[n]=g}}function d(i,r){var a=Math.abs(t(n(i),n(r))/(e(i)*e(r)));return a}function v(t,n){var i=(e(t)+e(n))/2,r=2/(i/Math.min(e(t),e(n))+Math.max(e(t),e(n))/i);return r}function y(t,n){var i=(e(t)+e(n))/2,r={x:(S[t.source].x+S[t.target].x)/2,y:(S[t.source].y+S[t.target].y)/2},a={x:(S[n.source].x+S[n.target].x)/2,y:(S[n.source].y+S[n.target].y)/2},s=i/(i+o(r,a));return s}function m(t,n){var e=s(S[n.source],{source:S[t.source],target:S[t.target]}),i=s(S[n.target],{source:S[t.source],target:S[t.target]}),r={x:(e.x+i.x)/2,y:(e.y+i.y)/2},a={x:(S[t.source].x+S[t.target].x)/2,y:(S[t.source].y+S[t.target].y)/2},g=Math.max(0,1-2*o(a,r)/o(e,i));return g}function x(t,n){return Math.min(m(t,n),m(n,t))}function w(t,n){var e=d(t,n)*v(t,n)*y(t,n)*x(t,n);return e}function _(t,n){return w(t,n)>=k}function b(){for(var t=0;t<M.length-1;t++)for(var n=t+1;n<M.length;n++)t!=n&&_(M[t],M[n])&&(A[t].push(n),A[n].push(t))}var S={},M=[],A=[],L=[],C=.1,F=.1,R=1,E=2,z=6,I=70,T=.6666667,k=.6,B=1e-8,D=function(){var t=F,n=I,e=R;g(),u(),p(e),b();for(var i=0;i<z;i++){for(var r=0;r<n;r++){for(var a=[],o=0;o<M.length;o++)a[o]=f(o,e,t);for(var s=0;s<M.length;s++)for(var l=0;l<e+1;l++)L[s][l].x+=a[s][l].x,L[s][l].y+=a[s][l].y}t/=2,e=2*e,n=T*n,p(e)}return L};return D.nodes=function(t){return 0==arguments.length?S:(S=t,D)},D.edges=function(t){return 0==arguments.length?M:(M=l(t),D)},D.bundling_stiffness=function(t){return 0==arguments.length?C:(C=t,D)},D.step_size=function(t){return 0==arguments.length?F:(F=t,D)},D.cycles=function(t){return 0==arguments.length?z:(z=t,D)},D.iterations=function(t){return 0==arguments.length?I:(I=t,D)},D.iterations_rate=function(t){return 0==arguments.length?T:(T=t,D)},D.subdivision_points_seed=function(t){return 0==arguments.length?P:(P=t,D)},D.subdivision_rate=function(t){return 0==arguments.length?E:(E=t,D)},D.compatbility_threshold=function(t){return 0==arguments.length?compatbility_threshold:(k=t,D)},D};J.prototype.get=function(t){var n=this.splitList,e=n.other;for(var i in n)if(t==i){e=n[i];break}return e},J.prototype.generateByDataSet=function(t){var n=["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],e=t.get();this.splitList={};for(var i=0,r=0;r<e.length&&(void 0===this.splitList[e[r].count]&&(this.splitList[e[r].count]=n[i],i++),!(i>=n.length-1));r++);this.splitList.other=n[n.length-1]},Q.prototype.get=function(t){for(var n=this.splitList,e=!1,i=0;i<n.length;i++)if((void 0===n[i].start||void 0!==n[i].start&&t>=n[i].start)&&(void 0===n[i].end||void 0!==n[i].end&&t<n[i].end)){e=n[i].value;break}return e},Q.prototype.generateByDataSet=function(t){var n=t.getMin("count"),e=t.getMax("count");this.generateByMinMax(n,e)},Q.prototype.generateByMinMax=function(t,n){var e=["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],i=(n-t)/7,r=t;this.splitList=[];for(var a=0;r<n;)this.splitList.push({start:r,end:r+i,value:e[a]}),a++,r+=i};var Ct=function(){function t(n,e){ot(this,t),this._call=n,this._runing=!1,this.start()}return st(t,[{key:"start",value:function(){this._runing=!0,requestAnimationFrame(this._launch.bind(this))}},{key:"stop",value:function(){this._runing=!1}},{key:"_launch",value:function(t){this._runing&&(this._call&&this._call(t),requestAnimationFrame(this._launch.bind(this)))}}]),t}(),Ft=Ft||function(){var t=[];return{getAll:function(){return t},removeAll:function(){t=[]},add:function(n){t.push(n)},remove:function(n){var e=t.indexOf(n);e!==-1&&t.splice(e,1)},update:function(n,e){if(0===t.length)return!1;var i=0;for(n=void 0!==n?n:Ft.now();i<t.length;)t[i].update(n)||e?i++:t.splice(i,1);return!0}}}();"undefined"==typeof window&&"undefined"!=typeof process?Ft.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?Ft.now=window.performance.now.bind(window.performance):void 0!==Date.now?Ft.now=Date.now:Ft.now=function(){return(new Date).getTime()},Ft.Tween=function(t){var n,e=t,i={},r={},a={},o=1e3,s=0,g=!1,u=!1,l=!1,h=0,c=null,f=Ft.Easing.Linear.None,p=Ft.Interpolation.Linear,d=[],v=null,y=!1,m=null,x=null,w=null;this.to=function(t,n){return r=t,void 0!==n&&(o=n),this},this.start=function(t){Ft.add(this),u=!0,y=!1,c=void 0!==t?t:Ft.now(),c+=h;for(var n in r){if(r[n]instanceof Array){if(0===r[n].length)continue;r[n]=[e[n]].concat(r[n])}void 0!==e[n]&&(i[n]=e[n],i[n]instanceof Array==!1&&(i[n]*=1),a[n]=i[n]||0)}return this},this.stop=function(){return u?(Ft.remove(this),u=!1,null!==w&&w.call(e,e),this.stopChainedTweens(),this):this},this.end=function(){return this.update(c+o),this},this.stopChainedTweens=function(){for(var t=0,n=d.length;t<n;t++)d[t].stop()},this.delay=function(t){return h=t,this},this.repeat=function(t){return s=t,this},this.repeatDelay=function(t){return n=t,this},this.yoyo=function(t){return g=t,this},this.easing=function(t){return f=t,this},this.interpolation=function(t){return p=t,this},this.chain=function(){return d=arguments,this},this.onStart=function(t){return v=t,this},this.onUpdate=function(t){return m=t,this},this.onComplete=function(t){return x=t,this},this.onStop=function(t){return w=t,this},this.update=function(t){var u,w,_;if(t<c)return!0;y===!1&&(null!==v&&v.call(e,e),y=!0),w=(t-c)/o,w=w>1?1:w,_=f(w);for(u in r)if(void 0!==i[u]){var b=i[u]||0,S=r[u];S instanceof Array?e[u]=p(S,_):("string"==typeof S&&(S="+"===S.charAt(0)||"-"===S.charAt(0)?b+parseFloat(S):parseFloat(S)),"number"==typeof S&&(e[u]=b+(S-b)*_))}if(null!==m&&m.call(e,_),1===w){if(s>0){isFinite(s)&&s--;for(u in a){if("string"==typeof r[u]&&(a[u]=a[u]+parseFloat(r[u])),g){var M=a[u];a[u]=r[u],r[u]=M}i[u]=a[u]}return g&&(l=!l),c=void 0!==n?t+n:t+h,!0}null!==x&&x.call(e,e);for(var A=0,L=d.length;A<L;A++)d[A].start(c+o);return!1}return!0}},Ft.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){var n=1.70158;return t*t*((n+1)*t-n)},Out:function(t){var n=1.70158;return--t*t*((n+1)*t+n)+1},InOut:function(t){var n=2.5949095;return(t*=2)<1?.5*(t*t*((n+1)*t-n)):.5*((t-=2)*t*((n+1)*t+n)+2)}},Bounce:{In:function(t){return 1-Ft.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*Ft.Easing.Bounce.In(2*t):.5*Ft.Easing.Bounce.Out(2*t-1)+.5}}},Ft.Interpolation={Linear:function(t,n){var e=t.length-1,i=e*n,r=Math.floor(i),a=Ft.Interpolation.Utils.Linear;return n<0?a(t[0],t[1],i):n>1?a(t[e],t[e-1],e-i):a(t[r],t[r+1>e?e:r+1],i-r)},Bezier:function(t,n){for(var e=0,i=t.length-1,r=Math.pow,a=Ft.Interpolation.Utils.Bernstein,o=0;o<=i;o++)e+=r(1-n,i-o)*r(n,o)*t[o]*a(i,o);return e},CatmullRom:function(t,n){var e=t.length-1,i=e*n,r=Math.floor(i),a=Ft.Interpolation.Utils.CatmullRom;return t[0]===t[e]?(n<0&&(r=Math.floor(i=e*(1+n))),a(t[(r-1+e)%e],t[r],t[(r+1)%e],t[(r+2)%e],i-r)):n<0?t[0]-(a(t[0],t[0],t[1],t[1],-i)-t[0]):n>1?t[e]-(a(t[e],t[e],t[e-1],t[e-1],i-e)-t[e]):a(t[r?r-1:0],t[r],t[e<r+1?e:r+1],t[e<r+2?e:r+2],i-r)},Utils:{Linear:function(t,n,e){return(n-t)*e+t},Bernstein:function(t,n){var e=Ft.Interpolation.Utils.Factorial;return e(t)/e(n)/e(t-n)},Factorial:function(){var t=[1];return function(n){var e=1;if(t[n])return t[n];for(var i=n;i>1;i--)e*=i;return t[n]=e,e}}(),CatmullRom:function(t,n,e,i,r){var a=.5*(e-t),o=.5*(i-n),s=r*r,g=r*s;return(2*n-2*e+a+o)*g+(-3*n+3*e-2*a-o)*s+a*r+n}}};var Rt="undefined"==typeof window?{}:window,Et=Rt.requestAnimationFrame||Rt.mozRequestAnimationFrame||Rt.webkitRequestAnimationFrame||Rt.msRequestAnimationFrame||function(t){return Rt.setTimeout(t,1e3/60)},zt=Rt.cancelAnimationFrame||Rt.mozCancelAnimationFrame||Rt.webkitCancelAnimationFrame||Rt.msCancelAnimationFrame||function(t){clearTimeout(t)};X.prototype={setOptions:function(t){this.options=t,t.stepsRange=t.stepsRange||{start:0,end:100},this.duration=t.duration||10,this.stepsRange=t.stepsRange,this._add=(this.stepsRange.end-this.stepsRange.start)/(60*this.duration),this._time=this.stepsRange.start},start:function(){this.running=!0,Et(this._tick),this.options.onStart&&this.options.onStart()},_tick:function(){this._time+=this._add,this._time>this.stepsRange.end&&(this._time=this.stepsRange.start),this.callback&&this.callback(this._time),this.running&&Et(this._tick)},isRunning:function(){return this.running},stop:function(){this.pause(),this._time=this.stepsRange.start,this.options.onStop&&this.options.onStop()},toggle:function(){this.running?this.pause():this.start()},pause:function(){this.running=!1,zt(this._tick),this.options.onPause&&this.options.onPause()}};var It=function(){function t(n,e,i){if(ot(this,t),!n||!e)return console.warn("id 和 type 为必填项"),!1;if("baidu"==e){if(!BMap)return console.warn("请先引入百度地图JS API"),!1}else console.warn("暂不支持你的地图类型");this.type=e;var r=i&&i.center?i.center:[106.962497,38.208726],a=i&&i.zoom?i.zoom:5,o=this.map=new BMap.Map(n,{enableMapClick:!1});o.centerAndZoom(new BMap.Point(r[0],r[1]),a),o.enableScrollWheelZoom(!0),o.setMapStyle({style:"light"})}return st(t,[{key:"addLayer",value:function(t,n){if("baidu"==this.type)return new mapv.baiduMapLayer(this.map,dataSet,n)}},{key:"getMap",value:function(){return this.map}}]),t}(),Tt="undefined"==typeof window?{}:window;Tt.BMap&&(K.prototype=new BMap.Overlay,K.prototype.initialize=function(t){this._map=t;var n=this.canvas=document.createElement("canvas");n.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";user-select:none;",n.style.mixBlendMode=this.mixBlendMode,this.adjustSize(),t.getPanes()[this.paneName].appendChild(n);var e=this;return t.addEventListener("resize",function(){e.adjustSize(),e._draw()}),this.canvas},K.prototype.adjustSize=function(){var t=this._map.getSize(),n=this.canvas,e=this.devicePixelRatio=Tt.devicePixelRatio;n.width=t.width*e,n.height=t.height*e,"2d"==this.context&&n.getContext(this.context).scale(e,e),n.style.width=t.width+"px",n.style.height=t.height+"px"},K.prototype.draw=function(){var t=this;clearTimeout(t.timeoutID),t.timeoutID=setTimeout(function(){t._draw()},15)},K.prototype._draw=function(){var t=this._map,n=t.getSize(),e=t.getCenter();if(e){var i=t.pointToOverlayPixel(e);this.canvas.style.left=i.x-n.width/2+"px",this.canvas.style.top=i.y-n.height/2+"px",this.dispatchEvent("draw"),this.options.update&&this.options.update.call(this)}},K.prototype.getContainer=function(){return this.canvas},K.prototype.show=function(){this.canvas||this._map.addOverlay(this),this.canvas.style.display="block"},K.prototype.hide=function(){this.canvas.style.display="none"},K.prototype.setZIndex=function(t){this.canvas.style.zIndex=t},K.prototype.getZIndex=function(){return this.zIndex});var kt={draw:function(t,n,e){var i=n.get();t.fillStyle="white",t.textAlign="center",t.textBaseline="middle";for(var r in e)t[r]=e[r];for(var a=e.offset||{x:0,y:0},o=e.textKey||"text",s=0,g=i.length;s<g;s++){var u=i[s].geometry._coordinates||i[s].geometry.coordinates;t.fillText(i[s][o],u[0]+a.x,u[1]+a.y)}}},Bt={draw:function(t,n,i){var r=n instanceof e?n.get():n;t.fillStyle="white",t.textAlign="center",t.textBaseline="middle";for(var a=i.offset||{x:0,y:0},o=0,s=r.length;o<s;o++)if(r[o].geometry){var g=r[o].icon||i.icon,u=r[o].geometry._coordinates||r[o].geometry.coordinates,l=u[0]-g.width/2+a.x,h=u[1]-g.height/2+a.y;r[o].deg&&(t.save(),t.translate(l,h),t.rotate(r[o].deg*Math.PI/180),t.translate(-l,-h)),t.drawImage(g,l,h),r[o].deg&&t.restore()}}};"undefined"!=typeof window&&requestAnimationFrame($),tt.prototype.clickEvent=function(t){for(var n=t.pixel,e=this.canvasLayer.canvas.getContext(this.context),i=this.dataSet.get(),r=0;r<i.length;r++)if(e.beginPath(),gt.draw(e,i[r],this.options),e.isPointInPath(n.x*this.canvasLayer.devicePixelRatio,n.y*this.canvasLayer.devicePixelRatio))return void this.options.methods.click(i[r],t);this.options.methods.click(null,t)},tt.prototype.mousemoveEvent=function(t){for(var n=t.pixel,e=this.canvasLayer.canvas.getContext(this.context),i=this.dataSet.get(),r=0;r<i.length;r++)if(e.beginPath(),gt.draw(e,i[r],this.options),e.isPointInPath(n.x*this.canvasLayer.devicePixelRatio,n.y*this.canvasLayer.devicePixelRatio))return void this.options.methods.mousemove(i[r],t);this.options.methods.mousemove(null,t)},tt.prototype.bindEvent=function(t){var n=this.map;this.options.methods&&(this.options.methods.click&&(n.setDefaultCursor("default"),n.addEventListener("click",this.clickEvent)),this.options.methods.mousemove&&n.addEventListener("mousemove",this.mousemoveEvent))},tt.prototype.unbindEvent=function(t){var n=this.map;this.options.methods&&(this.options.methods.click&&n.removeEventListener("click",this.clickEvent),this.options.methods.mousemove&&n.removeEventListener("mousemove",this.mousemoveEvent))},tt.prototype.transferToMercator=function(){var t=this.map.getMapType().getProjection();if("bd09mc"!==this.options.coordType){var n=this.dataSet.get();n=this.dataSet.transferCoordinate(n,function(n){var e=t.lngLatToPoint({lng:n[0],lat:n[1]});return[e.x,e.y]},"coordinates","coordinates_mercator"),this.dataSet._set(n)}},tt.prototype._canvasUpdate=function(t){if(this.canvasLayer){var n=this,i=n.options.animation,r=this.canvasLayer._map,a=Math.pow(2,18-r.getZoom()),o=r.getMapType().getProjection(),s=o.lngLatToPoint(r.getCenter()),g=new BMap.Pixel(s.x-r.getSize().width/2*a,s.y+r.getSize().height/2*a),u=this.canvasLayer.canvas.getContext(n.context);if(n.isEnabledTime()){if(void 0===t)return void rt(u);"2d"==this.context&&(u.save(),u.globalCompositeOperation="destination-out",u.fillStyle="rgba(0, 0, 0, .1)",u.fillRect(0,0,u.canvas.width,u.canvas.height),u.restore())}else rt(u);if("2d"==this.context)for(var l in n.options)u[l]=n.options[l];else u.clear(u.COLOR_BUFFER_BIT);var h=1;"2d"!=this.context&&(h=this.canvasLayer.devicePixelRatio);var c={fromColumn:"bd09mc"==n.options.coordType?"coordinates":"coordinates_mercator",transferCoordinate:function(t){var n=(t[0]-g.x)/a*h,e=(g.y-t[1])/a*h;return[n,e]}};void 0!==t&&(c.filter=function(n){var e=i.trails||10;return!!(t&&n.time>t-e&&n.time<t)});var f=n.dataSet.get(c),p=n.options.draw;if("bubble"==p||"intensity"==p||"category"==p||"choropleth"==p||"simple"==p)for(var d=0;d<f.length;d++){var v=f[d];"bubble"==n.options.draw?f[d]._size=n.intensity.getSize(v.count):f[d]._size=void 0,"intensity"==n.options.draw?"LineString"===f[d].geometry.type?f[d].strokeStyle=v.strokeStyle||n.intensity.getColor(v.count):f[d].fillStyle=v.fillStyle||n.intensity.getColor(v.count):"category"==n.options.draw?f[d].fillStyle=v.fillStyle||n.category.get(v.count):"choropleth"==n.options.draw&&(f[d].fillStyle=v.fillStyle||n.choropleth.get(v.count))}if(!(n.options.minZoom&&r.getZoom()<n.options.minZoom||n.options.maxZoom&&r.getZoom()>n.options.maxZoom)){switch("m"==n.options.unit&&n.options.size?n.options._size=n.options.size/a:n.options._size=n.options.size,n.options.draw){case"heatmap":ht.draw(u,new e(f),n.options);break;case"grid":case"honeycomb":var y=r.pointToPixel(new BMap.Point(0,0));n.options.offset={x:y.x,y:y.y},"grid"==n.options.draw?ct.draw(u,new e(f),n.options):ft.draw(u,new e(f),n.options);break;case"text":kt.draw(u,new e(f),n.options);break;case"icon":Bt.draw(u,f,n.options);break;case"clip":u.save(),u.fillStyle=n.options.fillStyle||"rgba(0, 0, 0, 0.5)",u.fillRect(0,0,u.canvas.width,u.canvas.height),ut.draw(u,f,n.options),u.beginPath(),gt.drawDataSet(u,new e(f),n.options),u.clip(),rt(u),u.restore();break;default:"webgl"==n.options.context?St.draw(n.canvasLayer.canvas.getContext("webgl"),f,n.options):ut.draw(u,f,n.options)}n.options.updateCallback&&n.options.updateCallback(t)}}},tt.prototype.isEnabledTime=function(){var t=this.options.animation,n=t&&!(t.enabled===!1);return n},tt.prototype.argCheck=function(t){"heatmap"==t.draw&&t.strokeStyle&&console.warn("[heatmap] options.strokeStyle is discard, pleause use options.strength [eg: options.strength = 0.1]")},tt.prototype.init=function(t){var n=this;if(n.options=t,this.context=n.options.context||"2d",n.intensity=new r({maxSize:n.options.maxSize,minSize:n.options.minSize,gradient:n.options.gradient,max:n.options.max||this.dataSet.getMax("count")}),n.category=new J(n.options.splitList),n.choropleth=new Q(n.options.splitList),void 0===n.options.splitList&&n.category.generateByDataSet(this.dataSet),n.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(n.options.zIndex),void 0===n.options.splitList){var e=n.options.min||this.dataSet.getMin("count"),i=n.options.max||this.dataSet.getMax("count");n.choropleth.generateByMinMax(e,i)}var a=n.options.animation;if("time"==n.options.draw||n.isEnabledTime()){a.stepsRange||(a.stepsRange={start:this.dataSet.getMin("time")||0,end:this.dataSet.getMax("time")||0});var o={step:a.stepsRange.start};n.animator=new Ft.Tween(o).onUpdate(function(){n._canvasUpdate(this.step)}).repeat(1/0),n.map.addEventListener("movestart",function(){n.isEnabledTime()&&n.animator&&(o.step=a.stepsRange.start,n.animator.stop())}),n.map.addEventListener("moveend",function(){n.isEnabledTime()&&n.animator&&n.animator.start()});var s=1e3*a.duration||5e3;n.animator.to({step:a.stepsRange.end},s),n.animator.start()}else n.animator&&n.animator.stop()},tt.prototype.show=function(){this.map.addOverlay(this.canvasLayer)},tt.prototype.hide=function(){this.map.removeOverlay(this.canvasLayer)},tt.prototype.destroy=function(){this.unbindEvent(),this.hide()},tt.prototype.update=function(t){var n=this,e=t.options,i=n.options;for(var r in e)i[r]=e[r];n.init(i),n.canvasLayer.draw()},tt.prototype.setOptions=function(t){var n=this;n.init(t),n.canvasLayer.draw()},tt.prototype.set=function(t){var n={globalAlpha:1,globalCompositeOperation:"source-over",imageSmoothingEnabled:!0,strokeStyle:"#000000",fillStyle:"#000000",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,lineDashOffset:0,font:"10px sans-serif",textAlign:"start",textBaseline:"alphabetic"},e=this,i=e.canvasLayer.canvas.getContext(e.context);for(var r in n)i[r]=n[r];e.init(t.options),e.canvasLayer.draw()},tt.prototype.getLegend=function(t){this.options.draw;if("intensity"==self.options.draw||"heatmap"==self.options.draw)return this.intensity.getLegend(t)};var Dt="undefined"==typeof window?{}:window;Dt.google&&Dt.google.maps&&(nt.prototype=new google.maps.OverlayView,nt.DEFAULT_PANE_NAME_="overlayLayer",nt.CSS_TRANSFORM_=function(){for(var t=document.createElement("div"),n=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],e=0;e<n.length;e++){var i=n[e];if(void 0!==t.style[i])return i}return n[0]}(),nt.prototype.requestAnimFrame_=Dt.requestAnimationFrame||Dt.webkitRequestAnimationFrame||Dt.mozRequestAnimationFrame||Dt.oRequestAnimationFrame||Dt.msRequestAnimationFrame||function(t){return Dt.setTimeout(t,1e3/60)},nt.prototype.cancelAnimFrame_=Dt.cancelAnimationFrame||Dt.webkitCancelAnimationFrame||Dt.mozCancelAnimationFrame||Dt.oCancelAnimationFrame||Dt.msCancelAnimationFrame||function(t){},nt.prototype.setOptions=function(t){void 0!==t.animate&&this.setAnimate(t.animate),void 0!==t.paneName&&this.setPaneName(t.paneName),void 0!==t.updateHandler&&this.setUpdateHandler(t.updateHandler),void 0!==t.resizeHandler&&this.setResizeHandler(t.resizeHandler),void 0!==t.resolutionScale&&this.setResolutionScale(t.resolutionScale),void 0!==t.map&&this.setMap(t.map)},nt.prototype.setAnimate=function(t){this.isAnimated_=!!t,this.isAnimated_&&this.scheduleUpdate()},nt.prototype.isAnimated=function(){return this.isAnimated_},nt.prototype.setPaneName=function(t){this.paneName_=t,this.setPane_()},nt.prototype.getPaneName=function(){return this.paneName_},nt.prototype.setPane_=function(){if(this.isAdded_){var t=this.getPanes();if(!t[this.paneName_])throw new Error('"'+this.paneName_+'" is not a valid MapPane name.');t[this.paneName_].appendChild(this.canvas)}},nt.prototype.setResizeHandler=function(t){this.resizeHandler_=t},nt.prototype.setResolutionScale=function(t){"number"==typeof t&&(this.resolutionScale_=t,this.resize_())},nt.prototype.setUpdateHandler=function(t){this.updateHandler_=t},nt.prototype.onAdd=function(){this.isAdded_||(this.isAdded_=!0,this.setPane_(),this.resizeListener_=google.maps.event.addListener(this.getMap(),"resize",this.resizeFunction_),this.centerListener_=google.maps.event.addListener(this.getMap(),"center_changed",this.repositionFunction_),this.resize_(),this.repositionCanvas_())},nt.prototype.onRemove=function(){this.isAdded_&&(this.isAdded_=!1,this.topLeft_=null,this.canvas.parentElement.removeChild(this.canvas),this.centerListener_&&(google.maps.event.removeListener(this.centerListener_),this.centerListener_=null),this.resizeListener_&&(google.maps.event.removeListener(this.resizeListener_),this.resizeListener_=null),this.requestAnimationFrameId_&&(this.cancelAnimFrame_.call(Dt,this.requestAnimationFrameId_),this.requestAnimationFrameId_=null))},nt.prototype.resize_=function(){if(this.isAdded_){var t=this.getMap(),n=t.getDiv().offsetWidth,e=t.getDiv().offsetHeight,i=n*this.resolutionScale_,r=e*this.resolutionScale_,a=this.canvas.width,o=this.canvas.height;a===i&&o===r||(this.canvas.width=i,
this.canvas.height=r,this.needsResize_=!0,this.scheduleUpdate()),this.canvasCssWidth_===n&&this.canvasCssHeight_===e||(this.canvasCssWidth_=n,this.canvasCssHeight_=e,this.canvas.style.width=n+"px",this.canvas.style.height=e+"px")}},nt.prototype.draw=function(){this.repositionCanvas_()},nt.prototype.repositionCanvas_=function(){var t=this.getMap(),n=t.getBounds().getNorthEast().lat(),e=t.getCenter(),i=Math.pow(2,t.getZoom()),r=e.lng()-180*this.canvasCssWidth_/(256*i);this.topLeft_=new google.maps.LatLng(n,r);var a=this.getProjection(),o=a.fromLatLngToDivPixel(e),s=-Math.round(this.canvasCssWidth_/2-o.x),g=-Math.round(this.canvasCssHeight_/2-o.y);this.canvas.style[nt.CSS_TRANSFORM_]="translate("+s+"px,"+g+"px)",this.scheduleUpdate()},nt.prototype.update_=function(){this.requestAnimationFrameId_=null,this.isAdded_&&(this.isAnimated_&&this.scheduleUpdate(),this.needsResize_&&this.resizeHandler_&&(this.needsResize_=!1,this.resizeHandler_()),this.updateHandler_&&this.updateHandler_())},nt.prototype.getTopLeft=function(){return this.topLeft_},nt.prototype.scheduleUpdate=function(){this.isAdded_&&!this.requestAnimationFrameId_&&(this.requestAnimationFrameId_=this.requestAnimFrame_.call(Dt,this.requestUpdateFunction_))});var Ot={getDataSet:function(t){for(var n=[],i=t.features,r=0;r<i.length;r++){var a=i[r],o=a.geometry,s=a.properties,g={};for(var u in s)g[u]=s[u];g.geometry=o,n.push(g)}return new e(n)}},Nt={CSVToArray:function(t,n){n=n||",";for(var e=new RegExp("(\\"+n+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+n+"\\r\\n]*))","gi"),i=[[]],r=null;r=e.exec(t);){var a=r[1];a.length&&a!==n&&i.push([]);var o;o=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],i[i.length-1].push(o)}return i},getDataSet:function(t){for(var n=this.CSVToArray(t,","),i=[],r=n[0],a=1;a<n.length-1;a++){for(var o=n[a],s={},g=0;g<o.length;g++){var u=o[g];"geometry"==r[g]&&(u=JSON.parse(u)),s[r[g]]=u}i.push(s)}return new e(i)}};t.version=it,t.canvasClear=rt,t.canvasResolutionScale=at,t.canvasDrawSimple=ut,t.canvasDrawHeatmap=ht,t.canvasDrawGrid=ct,t.canvasDrawHoneycomb=ft,t.webglDrawSimple=St,t.webglDrawPoint=xt,t.webglDrawLine=vt,t.webglDrawPolygon=bt,t.utilCityCenter=At,t.utilCurve=Lt,t.utilForceEdgeBundling=Pt,t.utilDataRangeIntensity=r,t.utilDataRangeCategory=J,t.utilDataRangeChoropleth=Q,t.Timer=Ct,t.Animator=X,t.Map=It,t.baiduMapCanvasLayer=K,t.baiduMapLayer=tt,t.googleMapCanvasLayer=nt,t.googleMapLayer=et,t.DataSet=e,t.geojson=Ot,t.csv=Nt,Object.defineProperty(t,"__esModule",{value:!0})});